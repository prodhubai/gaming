<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Friendly Fire - Light roasts. High laughs. No hard feelings. A fun party game for friends!">
    <meta name="theme-color" content="#ff6b35">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Friendly Fire">
    
    <!-- Open Graph / WhatsApp -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Friendly Fire - Roast Battle Game">
    <meta property="og:description" content="Light roasts. High laughs. Join the fun! ğŸ”¥">
    <meta property="og:image" content="/icon-512.png">
    
    <title>Friendly Fire - Light Roast Battle Game</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="/icon-192.png">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Game Header -->
        <header class="game-header">
            <h1>ğŸ”¥ Friendly Fire</h1>
            <p class="tagline">Light roasts. High laughs. No hard feelings.</p>
        </header>

        <!-- Home Screen - Choose Mode -->
        <div id="home-screen" class="screen active">
            <div class="home-container">
                <h2>Choose Game Mode</h2>
                <div class="mode-selection">
                    <button id="multiplayer-mode" class="btn btn-primary mode-btn">
                        ğŸŒ Multiplayer Mode
                        <span class="mode-description">Each player uses their own phone</span>
                    </button>
                    <button id="single-device-mode" class="btn btn-primary mode-btn">
                        ğŸ“± Single Device Mode
                        <span class="mode-description">Pass & play on one device</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Multiplayer Join/Create Screen -->
        <div id="multiplayer-setup" class="screen">
            <div class="setup-container">
                <h2>Multiplayer Game</h2>
                
                <div class="multiplayer-options">
                    <div class="option-card">
                        <h3>ğŸ® Create New Game</h3>
                        <p>Start a new game and invite friends</p>
                        <div class="form-group">
                            <label for="host-name">Your Name:</label>
                            <input type="text" id="host-name" placeholder="Enter your name" maxlength="20">
                        </div>
                        <button id="create-game" class="btn btn-primary">Create Game</button>
                    </div>
                    
                    <div class="divider">OR</div>
                    
                    <div class="option-card">
                        <h3>ğŸ”— Join Existing Game</h3>
                        <div class="form-group">
                            <label for="game-code">Enter Game Code:</label>
                            <input type="text" id="game-code" placeholder="e.g. ABCD1234" maxlength="8" style="text-transform: uppercase;">
                        </div>
                        <div class="form-group">
                            <label for="player-name-join">Your Name:</label>
                            <input type="text" id="player-name-join" placeholder="Enter your name" maxlength="20">
                        </div>
                        <button id="join-game" class="btn btn-primary">Join Game</button>
                    </div>
                </div>
                
                <button id="back-to-home" class="btn btn-secondary" style="margin-top: 20px;">â† Back</button>
            </div>
        </div>

        <!-- Multiplayer Lobby -->
        <div id="lobby-screen" class="screen">
            <div class="lobby-container">
                <h2>Game Lobby</h2>
                
                <div class="game-code-display">
                    <p>Share this code with friends:</p>
                    <div class="code-box">
                        <span id="lobby-game-code">XXXX</span>
                        <button id="copy-code" class="btn-copy">ğŸ“‹ Copy</button>
                    </div>
                    <button id="share-lobby-link" class="btn btn-secondary">ğŸ“± Share via WhatsApp</button>
                </div>
                
                <div class="players-waiting">
                    <h3>Players Joined (<span id="player-count-lobby">0</span>)</h3>
                    <div id="players-list" class="players-list">
                        <!-- Players will be listed here -->
                    </div>
                </div>
                
                <div class="lobby-settings" id="lobby-settings">
                    <div class="form-group">
                        <label for="lobby-rounds">Number of Rounds:</label>
                        <input type="number" id="lobby-rounds" min="1" max="10" value="5">
                    </div>
                    <div class="form-group">
                        <label>Game Mode:</label>
                        <select id="lobby-game-mode">
                            <option value="standard">Standard</option>
                            <option value="double-trouble">Double Trouble</option>
                            <option value="nice-roast">Nice Roast Only</option>
                            <option value="lightning">Lightning Round</option>
                        </select>
                    </div>
                </div>
                
                <button id="start-multiplayer-game" class="btn btn-primary" disabled>Start Game (Need 3+ players)</button>
                <button id="leave-lobby" class="btn btn-secondary">Leave Game</button>
            </div>
        </div>

        <!-- Waiting Screen (for multiplayer) -->
        <div id="waiting-screen" class="screen">
            <div class="waiting-container">
                <h2>â³ Waiting for Other Players...</h2>
                <p class="waiting-message" id="waiting-message">Waiting for submissions...</p>
                <div class="progress-info">
                    <span id="submissions-count">0</span> / <span id="total-players">0</span> players ready
                </div>
                <div class="spinner"></div>
            </div>
        </div>

        <!-- Setup Screen -->
        <div id="setup-screen" class="screen">
            <div class="setup-container">
                <!-- Install PWA Banner -->
                <div id="install-banner" class="install-banner" style="display: none;">
                    <p>ğŸ“± Install Friendly Fire as an app!</p>
                    <button id="install-btn" class="btn-install">Install</button>
                    <button id="dismiss-install" class="btn-dismiss">Ã—</button>
                </div>
                
                <h2>Game Setup</h2>
                <div class="form-group">
                    <label for="player-count">Number of Players:</label>
                    <input type="number" id="player-count" min="3" max="10" value="4">
                </div>
                <div id="player-names-section" class="player-names-section">
                    <h3>Player Names</h3>
                    <div id="player-names-inputs">
                        <!-- Player name inputs will be dynamically added here -->
                    </div>
                </div>
                <div class="form-group">
                    <label for="round-count">Number of Rounds:</label>
                    <input type="number" id="round-count" min="1" max="10" value="5">
                </div>
                <div class="form-group">
                    <label>Game Mode:</label>
                    <select id="game-mode">
                        <option value="standard">Standard</option>
                        <option value="double-trouble">Double Trouble</option>
                        <option value="nice-roast">Nice Roast Only</option>
                        <option value="lightning">Lightning Round</option>
                    </select>
                </div>
                <button id="start-game" class="btn btn-primary">Start Game</button>
                <button id="back-to-home-setup" class="btn btn-secondary">â† Back</button>
            </div>
        </div>

        <!-- Topic Screen -->
        <div id="topic-screen" class="screen">
            <div class="topic-container">
                <div class="round-info">
                    Round <span id="current-round">1</span> of <span id="total-rounds">5</span>
                </div>
                <div class="topic-card">
                    <h2>The Spark ğŸ’¡</h2>
                    <p id="topic-text" class="topic-text"></p>
                    <p class="topic-category"></p>
                </div>
                <button id="continue-to-submit" class="btn btn-primary">Ready to Roast!</button>
            </div>
        </div>

        <!-- Submit Screen -->
        <div id="submit-screen" class="screen">
            <div class="submit-container">
                <div class="round-info">
                    Round <span class="round-number">1</span> of <span class="total-rounds">5</span>
                </div>
                <div class="topic-reminder">
                    <strong>Topic:</strong> <span id="topic-reminder"></span>
                </div>
                
                <div class="safe-roasting-rules">
                    <h3>ğŸ”¥ Safe Roasting Rules</h3>
                    <ul>
                        <li>Keep it funny, not mean</li>
                        <li>No jokes about appearance, health, or family</li>
                        <li>Focus on quirks, habits, and shared memories</li>
                        <li>Make it absurd rather than personal</li>
                    </ul>
                </div>

                <div class="emoji-picker-section">
                    <h3>Add Some Flair ğŸ˜</h3>
                    <div class="emoji-grid" id="emoji-grid">
                        <!-- Emojis will be populated here -->
                    </div>
                </div>

                <div id="player-submissions">
                    <!-- Dynamic player submission forms will be added here -->
                </div>
                
                <button id="submit-all" class="btn btn-primary">Submit My Comment</button>
            </div>
        </div>

        <!-- Voting Screen -->
        <div id="voting-screen" class="screen">
            <div class="voting-container">
                <div class="round-info">
                    Round <span class="round-number">1</span> of <span class="total-rounds">5</span>
                </div>
                <h2>Vote for the Best!</h2>
                <div class="topic-reminder">
                    <strong>Topic:</strong> <span id="voting-topic-reminder"></span>
                </div>
                
                <div id="vote-categories">
                    <div class="vote-category">
                        <h3>ğŸ¤£ Funniest</h3>
                        <div id="funniest-votes" class="vote-options"></div>
                    </div>
                    <div class="vote-category">
                        <h3>ğŸ¯ Most On-Point</h3>
                        <div id="onpoint-votes" class="vote-options"></div>
                    </div>
                    <div class="vote-category">
                        <h3>ğŸ˜² Most Unexpected</h3>
                        <div id="unexpected-votes" class="vote-options"></div>
                    </div>
                </div>
                
                <button id="submit-votes" class="btn btn-primary">Submit Votes</button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <div class="results-container">
                <h2>Round Results ğŸ†</h2>
                <div class="topic-reminder">
                    <strong>Topic:</strong> <span id="results-topic-reminder"></span>
                </div>
                
                <div id="round-winners" class="winners-container">
                    <!-- Winners will be displayed here -->
                </div>

                <div id="all-comments" class="all-comments">
                    <h3>All Comments</h3>
                    <div id="comments-list"></div>
                </div>

                <div class="results-actions">
                    <button id="next-round" class="btn btn-primary">Next Round</button>
                    <button id="view-scoreboard" class="btn btn-secondary">View Scoreboard</button>
                    <button id="share-results" class="btn btn-secondary">
                        ğŸ“± Share Results
                    </button>
                    <button id="copy-results" class="btn btn-secondary">
                        ğŸ“‹ Copy Results
                    </button>
                </div>
            </div>
        </div>

        <!-- Final Scoreboard -->
        <div id="scoreboard-screen" class="screen">
            <div class="scoreboard-container">
                <h2>ğŸ† Final Scoreboard</h2>
                
                <div id="player-scores" class="player-scores">
                    <!-- Player scores will be displayed here -->
                </div>

                <div id="awards" class="awards-section">
                    <h3>Special Awards</h3>
                    <div id="awards-list">
                        <!-- Awards will be displayed here -->
                    </div>
                </div>

                <div class="scoreboard-actions">
                    <button id="play-again" class="btn btn-primary">Play Again</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyB7_QOFBHoIt711BmeuspL276-A5Mn_Pts",
            authDomain: "friednlyfire.firebaseapp.com",
            databaseURL: "https://friednlyfire-default-rtdb.firebaseio.com",
            projectId: "friednlyfire",
            storageBucket: "friednlyfire.firebasestorage.app",
            messagingSenderId: "414150791190",
            appId: "1:414150791190:web:cf3d9ba5a4037552ede537",
            measurementId: "G-R2GN8EXZQ9"
        };
        
        console.log('ğŸ”¥ Initializing Firebase...');
        window.firebaseApp = initializeApp(firebaseConfig);
        window.database = getDatabase(window.firebaseApp);
        console.log('âœ… Firebase initialized');
        console.log('âœ… Database ready:', window.database ? 'Yes' : 'No');
    </script>
    <script src="topics.js"></script>
    <script type="module" src="multiplayer.js"></script>
    <script src="game-multiplayer.js"></script>
</body>
</html>
